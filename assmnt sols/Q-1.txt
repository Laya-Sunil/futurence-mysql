-- 1 -Top Earners

SELECT d.name as Department, e.name as Employee, e.salary as Salary
FROM Employee e INNER JOIN Department d 
ON e.departmentid = d.id
WHERE 3>(
        SELECT COUNT(distinct c.salary) FROM Employee c
        WHERE c.departmentid=e.departmentid 
        AND e.salary<c.salary
        )
ORDER BY d.name, e.name;